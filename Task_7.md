# MLSecOps: замок для ящика пандоры
## Основные моменты доклада
### Проблематика ML-моделей
Для ML-моделей возникают уникальные угрозы и, вместе с тем, сохраняются класические.  
На момент доклада более 30 инструментов для проведения атак на ML-модели находятся в отрытом доступе.  
#### Терминология
Система искусственного интеллекта - одна или несколько моделей искусственного интеллекта для решения определённой задачи.  
Сильный искусственный интеллект - сопоставим с человеческими возможностями или превосходит их (не создан на момент доклада).  
Слабый искусственный интеллект - Результат машинного обучения, полученный в ходе оптимизации ML-моделей. Используется для решения узких прикладных задач.  

#### Основные типы машинного обучения

<table>
  <thead>
    <tr>
      <th colspan="3">Типы машинного обучения</th>
    </tr>
    <tr>
      <th>Обучение с учителем</th>
      <th>Обучение без учителя</th>
      <th>Обучение с подкреплением</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td valign="top">
        Например:
        <ul>
          <li>Классификация писем (spam detection)</li>
          <li>Распознавание изображений</li>
          <li>Регрессия (численное предсказание значений)</li>
        </ul>
      </td>
      <td valign="top">
        Например:
        <ul>
        <li>Кластеризация (выделение определённых признаков)</li>
        <li>Снижение размерности (в т.ч. распознавание лиц)</li>
          </ul>
      </td>
      <td valign="top">
        Например:
        <ul>
        <li>Создание беспилотного транспорта</li>
        <li>Промышленная робототехника</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td valign="top">
        Нейросети: <br>
        MLP, CNN, RNN, LSTM, GRU, Transformer
      </td>
      <td valign="top">
        Нейросети: <br>
        Autoencoder, VAE, GAN, Self-supervised Transformers
      </td>
      </td>
      <td valign="top">
        Нейросети: <br>
        DQN, CNN+RL, RNN+RL, Transformers+RL
      </td>
    </tr>
        <tr>
      <td valign="top">
        <ul>
        <li>Обучающие размеченные данные. <br>
        Данным присваиваются метки, чтобы модель изучиле признаки, по которым в дальнейшем она будет работать</li>
        <li>Валидационные размеченные данные. <br> 
        Используются для подбора параметров обучения</li>
        <li>Тестовые размеченные данные. <br> 
        Используются для оценки качества модели</li>
        </ul>
      </td>
      <td valign="top">
        <ul>
        <li>Обучающие неразмеченные данные</li>
        <li>Валидационные неразмеченные данные*</li>
        <li>Тестовые неразмеченные данные*</li>
        </ul>
        *применяются опционально
      </td>
      </td>
      <td valign="top">
        <ul> 
        <li>Обучающие динамические данные.</li>
        <li>За правильное выполнение функций модель получает баллы</li>
        <li>Модель оценивается в рамках метрик на основе баллов</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

Результатом обучения является ML-модель.  
По автономности и способности принимать решения без сторонней помощи ML-модели классифицируют:
- Функциональные модели. Получают входные данные, обрабатывают, возвращают выходные. Минимальная автономность
- Агенты. Информационные системы, взаимодействующие с функциональными моделями. Имеют автономность, память и планирование действий. Средняя автономность
- Мультиагентные системы. Большая задача разбивается на подзадачи и каждый агент выполняет свою подзадачу. Могут включать координирующий агент. Наибольшая автономность

С повышением автономности повышается вероятный ущерб в результате действий системы.  

### MLSecOps: объекты защиты и уникальные угрозы
MLSecOps - набор практик интеграции процессов обеспечения и управления ИБ во все этапы жизненного цикла ML-систем.  
Является надстройкой над DevSecOps и развитием MLOps.  
Цели MLSecOps: 
- конфиденциальность данных и МL-моделей
- целостность данных, кода и МL-моделей
- доступность МL-систем
- защита ИТ-инфраструктуры и МL-систем от атак

<table>
  <thead>
    <tr>
      <th colspan="2">Объекты защиты</th>
    </tr>
    <tr>
      <th>Базовые объекты защиты DevSecOps</th>
      <th>Новые объекты защиты MLSecOps</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td valign="top">
        <ul>
          <li>Компоненты</li>
          <li>Окружение разработки</li>
          <li>Среда эксплуатации</li>
          <li>Приложение</li>
        </ul>
        <td valign="top">
        <ul>
          <li>Данные</li>
          <li>ML-модели</li>
          <li>Потоки данных</li>
          <li>Привилегии</li>
        </ul>
        </td>
    </tr>
  </tbody>
</table>

Упрощенный пайплайн ML-систем:
1. **Сбор данных**. Подготовка требований к данным, анализ их происхождения, сбор инф-ции.
2. **Предобработка данных**. Очистка данных, разделение на обучающую, валидационную и тестовую выборки.
3. **Выбор ML-моделей**. Выбор архитектур и библиотек для создания ML-моделей.
4. **Обучение ML-моделей**.
5. **Верификация и валидация**.
6. **Публикация ML-модели в реестре**.
7. **Развёртывание ML-модели**.
8. **Мониторинг**



        
### Мероприятия и инструменты обеспечения ИБ ML-моделей
Внедрение MLSecOps требуется для:
- Разработчиков ML-моделей
- Разработчиков продуктов и услуг с применением ML-моделей
- Заказчиков продуктов на базе ML-моделей

Уникальные угрозы для функциональных ML-моделей:


### Фреймворк, объединяющий DevSecOps и MLSecOps
### Шаги выстраивания MLSecOps
___
## Ящик Пандоры
> Ты — инженер **DevSecOps**, начинающий погружаться в новый мир **MLSecOps**. Руководитель поручил тебе протестировать информационную безопасность нескольких ML-моделей перед их размещением в продуктовой среде.
> 
> Все нужные инструменты, библиотеки, зависимости и ML-модели уже находятся на ВМ, доступ в Интернет не требуется. Устанавливай Oracle VirtualBox, скачивай и запускай образ ВМ с ОС Ubuntu 22.04 ([ссылка](https://files.jet.su/d/swkqw2n9) и [зеркало](https://disk.360.yandex.com/d/JIIbuzeFEoF4Wg)), заходи в папку `/home/user/Documents/todo` — и приступай к выполнению задания. Мы даём тебе на выбор терминал и лёгкую графическую среду рабочего стола LXDE.
> 
> Логин: `user`
> Пароль: `strong_password`
> 
> Для выполнения заданий понадобится запустить инструменты и Python-скрипты из виртуального окружения Python:
> 
>     user@pandora-box:~$ cd Documents/todo/
> 
>     user@pandora-box:~/Documents/todo$ source myenv/bin/activate
> 
> Минимальные системные требования:
> 2 ЦП, 4 ГБ ОЗУ, 25 ГБ места на жёстком диске. Наличие видеокарты не обязательно.
> 
> Тебе также пригодятся эти материалы:
> 
> - https://pypi.org/project/modelaudit/
> - https://github.com/NVIDIA/garak
> - https://reference.garak.ai/en/latest/configurable.html
> - https://docs.sigstore.dev/cosign/
> - https://github.com/protectai/llm-guard

Для выполнения заданий предлагается виртуальная машина (описана в задании) для VirtualBox. Для корректного запуска следует отключить первый сетевой интерфейс - иначе будет возникать ошибка, что устройство не найдено.  
